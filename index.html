<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Steph Marie’s Bakehouse — Pre-Orders</title>
<style>
  :root{
    --pink:#f6a5c0;
    --pink-deep:#e56c95;
    --ink:#111113;
    --paper:#fff7fb;
    --accent:#2b2b2b;
  }
  *{box-sizing:border-box}
  html,body{margin:0; padding:0; background:var(--paper); color:var(--ink);}
  body{font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}

  /* Header */
  header{
    padding:14px 16px; border-bottom:1px solid #eee; background:#fff;
    position:sticky; top:0; z-index:10;
  }
  .brand{display:flex; align-items:center; gap:12px}
  .brand img{height:44px; width:auto; display:block}
  h1{font-size:1.05rem; margin:0}
  .tag{color:#666; font-size:.9rem}

  /* Layout */
  .wrap{max-width:1100px; margin:0 auto; padding:14px 16px 90px;} /* bottom pad for cart bar */
  .hero{
    display:grid; gap:12px; margin-top:8px;
  }
  .panel{
    background:#fff; border:1px solid #eee; border-radius:14px; padding:14px;
  }
  .panel h2{margin:0 0 8px; font-size:1.05rem}
  .notice{
    background:#fff0f5; border:1px dashed var(--pink-deep);
    padding:10px 12px; border-radius:10px; font-size:.95rem;
  }

  /* Product grid */
  .grid{display:grid; gap:12px; margin-top:14px;
    grid-template-columns:1fr; /* mobile first */
  }
  @media (min-width:560px){ .grid{grid-template-columns:repeat(2,1fr);} }
  @media (min-width:900px){ .grid{grid-template-columns:repeat(3,1fr);} }

  .card{background:#fff; border:1px solid #eee; border-radius:14px; overflow:hidden; display:flex; flex-direction:column}
  .card img{width:100%; aspect-ratio: 4/3; object-fit:cover; display:block}
  .meta{padding:12px}
  .name{font-weight:700}
  .price{color:#444; margin-top:2px}
  .opts{display:flex; gap:10px; align-items:center; margin-top:10px}
  .qty{
    display:flex; align-items:center; gap:8px; border:1px solid #eee; border-radius:12px; padding:8px 10px;
  }
  .qty button{
    border:0; background:#f5f5f5; width:36px; height:36px; border-radius:10px; cursor:pointer; font-size:18px;
  }
  .add{
    margin-left:auto; border:0; background:var(--pink-deep); color:#fff;
    padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:700; min-width:110px;
  }

  /* Sticky Cart bar (mobile) */
  .cartbar{
    position:fixed; left:0; right:0; bottom:0; z-index:20;
    background:#fff; border-top:1px solid #eee;
    padding:10px 14px; display:flex; align-items:center; gap:12px;
    box-shadow:0 -6px 20px #0001;
  }
  .cartbadge{
    background:var(--pink); color:#000; font-weight:700; padding:6px 10px; border-radius:999px; min-width:34px; text-align:center;
  }
  .cartsum{flex:1; min-width:0}
  .cartsum .t{display:block; font-size:.9rem; color:#666; line-height:1.2}
  .cartsum .v{display:block; font-weight:800}
  .checkout-btn{
    border:0; background:var(--pink-deep); color:#fff; padding:12px 16px; border-radius:12px; font-weight:800; cursor:pointer;
  }
  .checkout-btn:disabled{opacity:.5}

  /* Drawer */
  .drawer{
    position:fixed; left:0; right:0; bottom:0; z-index:50;
    background:#fff; border-top-left-radius:16px; border-top-right-radius:16px;
    transform:translateY(100%); transition:transform .28s ease-out;
    box-shadow:0 -14px 40px #0003; max-height:85vh; display:flex; flex-direction:column;
  }
  .drawer.open{transform:translateY(0)}
  .drawer .grab{width:48px; height:5px; background:#ddd; border-radius:999px; margin:8px auto 6px;}
  .drawer header{position:sticky; top:0; border-bottom:1px solid #eee}
  .drawer h3{margin:0; font-size:1.05rem}
  .drawer-body{padding:12px 14px; overflow:auto}
  .cart-items{border:1px solid #f0f0f0; border-radius:12px; padding:8px; max-height:220px; overflow:auto}
  .ci{display:grid; grid-template-columns:1fr auto auto; gap:8px; align-items:center; padding:6px 0; border-bottom:1px dashed #eee}
  .ci:last-child{border-bottom:0}
  .ci .qty-mini{display:flex; align-items:center; gap:8px}
  .ci button{width:32px; height:32px; border:0; background:#f5f5f5; border-radius:8px; font-size:18px; cursor:pointer}
  .totals{display:flex; justify-content:space-between; margin:10px 0; font-weight:800}
  .preorder{display:grid; gap:10px; margin-top:6px}
  input, textarea, select{
    width:100%; padding:12px 14px; border:1px solid #ddd; border-radius:12px; font:inherit; background:#fff;
  }
  label.small{font-size:.9rem; color:#666}
  .pay-buttons{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px}
  .pay{border:1px solid #eee; background:#fafafa; padding:12px 14px; border-radius:12px; cursor:pointer; font-weight:700}
  .pay.primary{background:var(--pink); border-color:var(--pink-deep); color:#000}
  .qr{display:none; margin-top:10px; text-align:center}
  .qr img{max-width:200px; height:auto; display:block; margin:0 auto 6px}
  .muted{color:#666; font-size:.9rem}
  .drawer-footer{padding:12px 14px 20px; border-top:1px solid #eee; color:#666; font-size:.9rem}

  /* Desktop: show drawer by default trigger remains; cart bar still useful */
  @media (min-width:900px){
    .drawer{max-width:680px; margin:0 auto; border-top-left-radius:18px; border-top-right-radius:18px}
  }
</style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="logo.png" alt="Steph Marie’s Bakehouse Logo" />
      <div>
        <h1>Steph Marie’s Bakehouse</h1>
        <div class="tag">Hand-made. Homestead spirit. Pre-order & pick up</div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <section class="hero">
      <div class="panel">
        <h2>How pre-orders work</h2>
        <ol style="margin:0; padding-left:18px">
          <li>Add items to your cart</li>
          <li>Pick a pickup date/time and add your info</li>
          <li>Tap a payment option — link or QR appears</li>
        </ol>
        <p class="notice" style="margin-top:10px">
          Apple Pay note: true on-site Apple Pay needs Stripe or Square.
          Use PayPal/Venmo/Cash App now; we can add Apple Pay later without changing your layout.
        </p>
      </div>
      <div class="panel">
        <h2>This week’s pickup</h2>
        <p>Enter your preferred pickup at checkout. We’ll confirm by text.</p>
        <ul style="margin:8px 0 0; padding-left:18px">
          <li><strong>Location:</strong> <span id="pickupLocation">Downtown farmer’s market booth</span></li>
          <li><strong>Window:</strong> <span id="pickupWindow">Sat 9:00a–12:00p</span></li>
        </ul>
      </div>
    </section>

    <!-- Product grid -->
    <section>
      <h2 style="margin:16px 0 10px; font-size:1.05rem">Baked goods — available for pre-order</h2>
      <div class="grid" id="grid">
        <!-- Item 1 -->
        <article class="card" data-id="cinnamon-roll" data-name="Cinnamon Roll (6-pack)" data-price="18.00">
          <img src="https://images.unsplash.com/photo-1541976076758-347942db1971?q=80&w=1200&auto=format&fit=crop" alt="Cinnamon rolls" />
          <div class="meta">
            <div class="name">Cinnamon Roll (6-pack)</div>
            <div class="price">$18.00</div>
            <div class="opts">
              <div class="qty" data-for="cinnamon-roll">
                <button class="minus" aria-label="decrease">−</button>
                <span class="val">1</span>
                <button class="plus" aria-label="increase">+</button>
              </div>
              <button class="add">Add</button>
            </div>
          </div>
        </article>

        <!-- Item 2 -->
        <article class="card" data-id="sourdough" data-name="Country Sourdough" data-price="9.00">
          <img src="https://images.unsplash.com/photo-1608198093002-ad4e005484ec?q=80&w=1200&auto=format&fit=crop" alt="Sourdough loaf" />
          <div class="meta">
            <div class="name">Country Sourdough</div>
            <div class="price">$9.00</div>
            <div class="opts">
              <div class="qty" data-for="sourdough">
                <button class="minus">−</button>
                <span class="val">1</span>
                <button class="plus">+</button>
              </div>
              <button class="add">Add</button>
            </div>
          </div>
        </article>

        <!-- Item 3 -->
        <article class="card" data-id="choc-chip" data-name="Chocolate Chip Cookies (12)" data-price="16.00">
          <img src="https://images.unsplash.com/photo-1541599188778-b4d7a3a3af81?q=80&w=1200&auto=format&fit=crop" alt="Cookies" />
          <div class="meta">
            <div class="name">Chocolate Chip Cookies (12)</div>
            <div class="price">$16.00</div>
            <div class="opts">
              <div class="qty" data-for="choc-chip">
                <button class="minus">−</button>
                <span class="val">1</span>
                <button class="plus">+</button>
              </div>
              <button class="add">Add</button>
            </div>
          </div>
        </article>

        <!-- Add more items as needed -->
      </div>
    </section>
  </div>

  <!-- Sticky Cart Bar -->
  <div class="cartbar" id="cartBar">
    <div class="cartbadge" id="cartCount">0</div>
    <div class="cartsum">
      <span class="t">Your cart</span>
      <span class="v" id="cartTotal">$0.00</span>
    </div>
    <button class="checkout-btn" id="openCheckout" disabled>Checkout</button>
  </div>

  <!-- Slide-up Drawer -->
  <div class="drawer" id="drawer">
    <div class="grab" aria-hidden="true"></div>
    <header style="background:#fff; padding:10px 14px; display:flex; justify-content:space-between; align-items:center">
      <h3>Pre-order checkout</h3>
      <button id="closeDrawer" style="border:0; background:#f5f5f5; padding:8px 10px; border-radius:10px; cursor:pointer">Close</button>
    </header>
    <div class="drawer-body">
      <div class="cart-items" id="cartItems"><div class="muted">Cart is empty. Add something tasty</div></div>
      <div class="totals"><span>Total</span><span id="total">$0.00</span></div>

      <div class="preorder">
        <input id="custName" placeholder="Your name" autocomplete="name" />
        <input id="custPhone" placeholder="Mobile number for pickup text" inputmode="tel" autocomplete="tel" />
        <label class="small">Pickup date & time</label>
        <input id="pickupDT" type="datetime-local" />
        <textarea id="notes" rows="2" placeholder="Notes (allergies, special requests)"></textarea>
      </div>

      <div style="margin-top:10px">
        <label class="small">Pay now to confirm your order</label>
        <div class="pay-buttons">
          <!-- Replace handles/links below -->
          <button class="pay primary" data-pay="venmo">Pay Venmo</button>
          <button class="pay" data-pay="cashapp">Pay Cash App</button>
          <button class="pay" data-pay="paypal">Pay PayPal</button>
          <button class="pay" data-pay="apple">Apple Pay (info)</button>
        </div>

        <div class="qr" id="qrBox">
          <img id="qrImg" alt="Payment QR" />
          <div class="muted" id="qrNote"></div>
        </div>

        <div class="muted" style="margin-top:8px">
          After paying, you’ll receive a text confirmation. Need help?
          <a href="#" onclick="alert('Text us at the number above after you pay, and we will confirm your pickup window.'); return false;">Tap here</a>
        </div>
      </div>
    </div>

    <div class="drawer-footer">Thank you for supporting a local, home-based bakehouse</div>
  </div>

<script>
/* ================ Basic cart ================ */
const money = n => `$${n.toFixed(2)}`;
const cart = new Map(); // id -> {id,name,price,qty}

const cartItemsEl = document.getElementById('cartItems');
const totalEl = document.getElementById('total');
const cartBarTotal = document.getElementById('cartTotal');
const cartCountEl = document.getElementById('cartCount');
const openCheckoutBtn = document.getElementById('openCheckout');

function renderCart(){
  cartItemsEl.innerHTML = '';
  let sum = 0, count = 0;
  if(cart.size === 0){
    cartItemsEl.innerHTML = '<div class="muted">Cart is empty. Add something tasty</div>';
  } else {
    [...cart.values()].forEach(item=>{
      sum += item.price * item.qty;
      count += item.qty;
      const row = document.createElement('div');
      row.className = 'ci';
      row.innerHTML = `
        <div><strong>${item.name}</strong><div class="muted">${money(item.price)} ea</div></div>
        <div class="qty-mini">
          <button aria-label="decrease" onclick="updateQty('${item.id}',-1)">−</button>
          <span>${item.qty}</span>
          <button aria-label="increase" onclick="updateQty('${item.id}',1)">+</button>
        </div>
        <div>${money(item.price*item.qty)}</div>
      `;
      cartItemsEl.appendChild(row);
    });
  }
  totalEl.textContent = money(sum);
  cartBarTotal.textContent = money(sum);
  cartCountEl.textContent = count;
  openCheckoutBtn.disabled = (count === 0);
}

function updateQty(id, delta){
  const it = cart.get(id);
  if(!it) return;
  it.qty += delta;
  if(it.qty <= 0) cart.delete(id);
  renderCart();
}

document.querySelectorAll('.card').forEach(card=>{
  const id = card.dataset.id;
  const name = card.dataset.name;
  const price = parseFloat(card.dataset.price);
  const box = card.querySelector('.qty');
  const valEl = box.querySelector('.val');
  box.querySelector('.plus').onclick = ()=>{ valEl.textContent = +valEl.textContent + 1; };
  box.querySelector('.minus').onclick = ()=>{ valEl.textContent = Math.max(1, +valEl.textContent - 1); };
  card.querySelector('.add').onclick = ()=>{
    const qty = +valEl.textContent;
    const existing = cart.get(id);
    if(existing){ existing.qty += qty; } else { cart.set(id,{id,name,price,qty}); }
    valEl.textContent = 1;
    renderCart();
    openDrawer(); // show checkout immediately on add (nice on phones)
  };
});
renderCart();

/* ================ Drawer controls ================ */
const drawer = document.getElementById('drawer');
document.getElementById('openCheckout').addEventListener('click', openDrawer);
document.getElementById('closeDrawer').addEventListener('click', closeDrawer);

// Close drawer on background swipe / ESC (basic)
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeDrawer(); });

function openDrawer(){ drawer.classList.add('open'); }
function closeDrawer(){ drawer.classList.remove('open'); }

/* ================ Payments ================ */
// TODO: replace with your real handles/links
const VENMO_HANDLE = "StephMariesBakehouse"; // no @
const CASHAPP_TAG  = "StephMariesBakehouse"; // no $
const PAYPAL_ME    = "stephmariesbakehouse"; // paypal.me/<this>

function totalAmount(){
  let t=0; cart.forEach(it=>t+=it.price*it.qty); return Math.round(t*100)/100;
}
function orderSummary(){
  const items = [...cart.values()].map(i=>`${i.qty} × ${i.name}`).join(', ');
  const name = document.getElementById('custName').value.trim();
  const phone = document.getElementById('custPhone').value.trim();
  const dt = document.getElementById('pickupDT').value;
  const notes = document.getElementById('notes').value.trim();
  return {items,name,phone,dt,notes};
}
function requireBasics(){
  if(cart.size===0){ alert('Please add at least one item'); return false; }
  const {name,phone,dt} = orderSummary();
  if(!name || !phone || !dt){ alert('Please enter name, mobile, and pickup date/time'); return false; }
  return true;
}
function showQR(src, note){
  const qrBox = document.getElementById('qrBox');
  const qrImg = document.getElementById('qrImg');
  const qrNote = document.getElementById('qrNote');
  if(!src){ qrBox.style.display='none'; return; }
  qrImg.src = src; qrNote.textContent = note || ''; qrBox.style.display = 'block';
}

// Quick QR via Google Charts
function qrURL(text){
  const enc = encodeURIComponent(text);
  return `https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl=${enc}`;
}

function onPay(kind){
  if(!requireBasics()) return;
  const total = totalAmount();
  const {items,name,phone,dt} = orderSummary();
  const memo = `Bakehouse ${name} ${phone} ${new Date(dt).toLocaleString()} — ${items}`.slice(0,120);

  if(kind==='venmo'){
    const venmoLink = `venmo://paycharge?txn=pay&recipients=${encodeURIComponent(VENMO_HANDLE)}&amount=${total}&note=${encodeURIComponent(memo)}`;
    const web = `https://venmo.com/${encodeURIComponent(VENMO_HANDLE)}`;
    showQR(qrURL(web), `If the Venmo app doesn’t open, scan or tap to pay: ${web}`);
    window.location.href = venmoLink;
  }
  if(kind==='cashapp'){
    const url = `https://cash.app/$${encodeURIComponent(CASHAPP_TAG)}/${total}`;
    showQR(qrURL(url), `Cash App: $${CASHAPP_TAG} — amount should prefill. Add note: "${memo}"`);
    window.open(url,'_blank');
  }
  if(kind==='paypal'){
    const url = `https://paypal.me/${encodeURIComponent(PAYPAL_ME)}/${total}`;
    showQR(qrURL(url), `PayPal: @${PAYPAL_ME}. If amount doesn’t prefill, enter ${total.toFixed(2)} and add note "${memo}"`);
    window.open(url,'_blank');
  }
  if(kind==='apple'){
    alert(
`Apple Pay on your site uses a processor like Stripe or Square.
We can enable it with:
• Stripe: Payment Links or on-site checkout (domain verification)
• Square: Checkout links or Tap to Pay on iPhone

For now, please use Venmo / Cash App / PayPal above.`
    );
    showQR('', '');
  }
}

document.querySelectorAll('.pay').forEach(btn=>{
  btn.addEventListener('click', ()=> onPay(btn.dataset.pay));
});
</script>
</body>
</html>
